var e=require("buffer"),t=require("web3"),n=require("events"),r=require("isutf8"),o=require("eth-sig-util"),a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},i={},u=a.parcelRequired425;null==u&&((u=function(e){if(e in s)return s[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return s[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){i[e]=t},a.parcelRequired425=u),u.register("aYpJk",(function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rpcUrl=t}var t,r,o;return t=e,(r=[{key:"getBlockNumber",value:function(){return this.call({jsonrpc:"2.0",method:"eth_blockNumber",params:[]}).then((function(e){return e.result}))}},{key:"getBlockByNumber",value:function(e){return this.call({jsonrpc:"2.0",method:"eth_getBlockByNumber",params:[e,!1]}).then((function(e){return e.result}))}},{key:"getFilterLogs",value:function(e){return this.call({jsonrpc:"2.0",method:"eth_getLogs",params:[e]})}},{key:"call",value:function(e){return fetch(this.rpcUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if(!e.result&&e.error)throw console.log("<== rpc error",e.error),new Error(e.error.message||"rpc error");return e}))}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=r})),u.register("88ldd",(function(e,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e){var t="function"==typeof Map?new Map:void 0;return a=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,e)},a(e)}function s(e,t,n){return(s=i()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&u(o,n.prototype),o}).apply(null,arguments)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(d,e);var t,n,a,s,l,f=(t=d,n=i(),function(){var e,r=c(t);if(n){var a=c(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return o(this,e)});function d(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=f.call(this)).code=e,n.message=t,n}return a=d,(s=[{key:"toString",value:function(){return"".concat(this.message," (").concat(this.code,")")}}])&&r(a.prototype,s),l&&r(a,l),Object.defineProperty(a,"prototype",{writable:!1}),d}(a(Error));e.exports=l})),u.register("htMot",(function(t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,o,s;return n=t,s=[{key:"genId",value:function(){return(new Date).getTime()+Math.floor(1e3*Math.random())}},{key:"flatMap",value:function(e,t){var n;return(n=[]).concat.apply(n,r(e.map(t)))}},{key:"intRange",value:function(e,t){return e>=t?[]:new Array(t-e).fill().map((function(t,n){return n+e}))}},{key:"hexToInt",value:function(e){return null==e?e:Number.parseInt(e,16)}},{key:"intToHex",value:function(e){return null==e?e:"0x"+e.toString(16)}},{key:"messageToBuffer",value:function(t){var n=e.Buffer.from([]);try{n="string"==typeof t?e.Buffer.from(t.replace("0x",""),"hex"):e.Buffer.from(t)}catch(e){console.log("messageToBuffer error: ".concat(e))}return n}},{key:"bufferToHex",value:function(t){return"0x"+e.Buffer.from(t).toString("hex")}}],(o=null)&&a(n.prototype,o),s&&a(n,s),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.exports=s})),u.register("faKjY",(function(e,t){"use strict";var n,r=(n=u("htMot"))&&n.__esModule?n:{default:n};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.intIds=new Map}var t,n,a;return t=e,(n=[{key:"tryIntifyId",value:function(e){if(e.id){if("number"!=typeof e.id){var t=r.default.genId();this.intIds.set(t,e.id),e.id=t}}else e.id=r.default.genId()}},{key:"tryRestoreId",value:function(e){var t=this.tryPopId(e.id);t&&(e.id=t)}},{key:"tryPopId",value:function(e){var t=this.intIds.get(e);return t&&this.intIds.delete(e),t}}])&&o(t.prototype,n),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=a}));var c=y(t),l=y(u("aYpJk")),f=y(u("88ldd")),d=y(u("htMot")),p=y(u("faKjY")),h=y(r);function y(e){return e&&e.__esModule?e:{default:e}}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var o=_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w(this,n)}}function w(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(i,n.EventEmitter);var t,r,a,s=m(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=s.call(this)).setConfig(e),t.idMapping=new p.default,t.callbacks=new Map,t.wrapResults=new Map,t.isTrust=!0,t.isDebug=!!e.isDebug,t.emitConnect(e.chainId),t}return t=i,r=[{key:"setAddress",value:function(e){var t=(e||"").toLowerCase();this.address=t,this.ready=!!e;for(var n=0;n<window.frames.length;n++){var r=window.frames[n];r.ethereum&&r.ethereum.isTrust&&(r.ethereum.address=t,r.ethereum.ready=!!e)}}},{key:"setConfig",value:function(e){this.setAddress(e.address),this.chainId=e.chainId,this.rpc=new l.default(e.rpcUrl),this.isDebug=!!e.isDebug}},{key:"request",value:function(e){var t=this;return this instanceof i||(t=window.ethereum),t._request(e,!1)}},{key:"isConnected",value:function(){return!0}},{key:"enable",value:function(){return console.log('enable() is deprecated, please use window.ethereum.request({method: "eth_requestAccounts"}) instead.'),this.request({method:"eth_requestAccounts",params:[]})}},{key:"send",value:function(e){var t={jsonrpc:"2.0",id:e.id};switch(e.method){case"eth_accounts":t.result=this.eth_accounts();break;case"eth_coinbase":t.result=this.eth_coinbase();break;case"net_version":t.result=this.net_version();break;case"eth_chainId":t.result=this.eth_chainId();break;default:throw new f.default(4200,"Trust does not support calling ".concat(e.method," synchronously without a callback. Please provide a callback parameter to call ").concat(e.method," asynchronously."))}return t}},{key:"sendAsync",value:function(e,t){console.log("sendAsync(data, callback) is deprecated, please use window.ethereum.request(data) instead.");var n=this;this instanceof i||(n=window.ethereum),Array.isArray(e)?Promise.all(e.map(n._request.bind(n))).then((function(e){return t(null,e)})).catch((function(e){return t(e,null)})):n._request(e).then((function(e){return t(null,e)})).catch((function(e){return t(e,null)}))}},{key:"_request",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.idMapping.tryIntifyId(e),this.isDebug&&console.log("==> _request payload ".concat(JSON.stringify(e))),new Promise((function(r,o){switch(e.id||(e.id=d.default.genId()),t.callbacks.set(e.id,(function(e,t){e?o(e):r(t)})),t.wrapResults.set(e.id,n),e.method){case"eth_accounts":return t.sendResponse(e.id,t.eth_accounts());case"eth_coinbase":return t.sendResponse(e.id,t.eth_coinbase());case"net_version":return t.sendResponse(e.id,t.net_version());case"eth_chainId":return t.sendResponse(e.id,t.eth_chainId());case"eth_sign":return t.eth_sign(e);case"personal_sign":return t.personal_sign(e);case"personal_ecRecover":return t.personal_ecRecover(e);case"eth_signTypedData_v3":return t.eth_signTypedData(e,!1);case"eth_signTypedData":case"eth_signTypedData_v4":return t.eth_signTypedData(e,!0);case"eth_sendTransaction":return t.eth_sendTransaction(e);case"eth_requestAccounts":return t.eth_requestAccounts(e);case"wallet_watchAsset":return t.wallet_watchAsset(e);case"wallet_addEthereumChain":return t.wallet_addEthereumChain(e);case"eth_newFilter":case"eth_newBlockFilter":case"eth_newPendingTransactionFilter":case"eth_uninstallFilter":case"eth_subscribe":throw new f.default(4200,"Trust does not support calling ".concat(e.method,". Please use your own solution"));default:return t.callbacks.delete(e.id),t.wrapResults.delete(e.id),t.rpc.call(e).then((function(e){t.isDebug&&console.log("<== rpc response ".concat(JSON.stringify(e))),r(n?e:e.result)})).catch(o)}}))}},{key:"emitConnect",value:function(e){this.emit("connect",{chainId:e})}},{key:"eth_accounts",value:function(){return this.address?[this.address]:[]}},{key:"eth_coinbase",value:function(){return this.address}},{key:"net_version",value:function(){return this.chainId.toString(10)||null}},{key:"eth_chainId",value:function(){return"0x"+this.chainId.toString(16)}},{key:"eth_sign",value:function(e){var t=d.default.messageToBuffer(e.params[1]),n=d.default.bufferToHex(t);(0,h.default)(t)?this.postMessage("signPersonalMessage",e.id,{data:n}):this.postMessage("signMessage",e.id,{data:n})}},{key:"personal_sign",value:function(e){var t=e.params[0];if(0===d.default.messageToBuffer(t).length){var n=d.default.bufferToHex(t);this.postMessage("signPersonalMessage",e.id,{data:n})}else this.postMessage("signPersonalMessage",e.id,{data:t})}},{key:"personal_ecRecover",value:function(e){this.postMessage("ecRecover",e.id,{signature:e.params[1],message:e.params[0]})}},{key:"eth_signTypedData",value:function(e,t){var n=JSON.parse(e.params[1]),r=o.TypedDataUtils.sign(n,t);this.postMessage("signTypedMessage",e.id,{data:"0x"+r.toString("hex"),raw:e.params[1]})}},{key:"eth_sendTransaction",value:function(e){this.postMessage("signTransaction",e.id,e.params[0])}},{key:"eth_requestAccounts",value:function(e){this.postMessage("requestAccounts",e.id,{})}},{key:"wallet_watchAsset",value:function(e){var t=e.params.options;this.postMessage("watchAsset",e.id,{type:e.type,contract:t.address,symbol:t.symbol,decimals:t.decimals||0})}},{key:"wallet_addEthereumChain",value:function(e){this.postMessage("addEthereumChain",e.id,e.params[0])}},{key:"postMessage",value:function(e,t,n){if(this.ready||"requestAccounts"===e){var r={id:t,name:e,object:n};window.trustwallet.postMessage?window.trustwallet.postMessage(r):window.webkit.messageHandlers[e].postMessage(r)}else this.sendError(t,new f.default(4100,"provider is not ready"))}},{key:"sendResponse",value:function(e,t){var n=this.idMapping.tryPopId(e)||e,r=this.callbacks.get(e),o=this.wrapResults.get(e),a={jsonrpc:"2.0",id:n};if("object"===b(t)&&t.jsonrpc&&t.result?a.result=t.result:a.result=t,this.isDebug&&console.log("<== sendResponse id: ".concat(e,", result: ").concat(JSON.stringify(t),", data: ").concat(JSON.stringify(a))),r)r(null,o?a:t),this.callbacks.delete(e);else{console.log("callback id: ".concat(e," not found"));for(var s=0;s<window.frames.length;s++){var i=window.frames[s];try{i.ethereum.callbacks.has(e)&&i.ethereum.sendResponse(e,t)}catch(e){console.log("send response to frame error: ".concat(e))}}}}},{key:"sendError",value:function(e,t){console.log("<== ".concat(e," sendError ").concat(t));var n=this.callbacks.get(e);n&&(n(t instanceof Error?t:new Error(t),null),this.callbacks.delete(e))}}],r&&g(t.prototype,r),a&&g(t,a),Object.defineProperty(t,"prototype",{writable:!1}),i}();window.trustwallet={Provider:k,Web3:c.default,postMessage:null};